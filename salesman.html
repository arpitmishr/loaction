<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Salesman Dashboard</title>

  <link rel="stylesheet" href="css/style.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body>

<div id="loader">Loading...</div>

<div id="content" style="display:none;">

  <!-- NAVBAR -->
  <nav>
    <h1>Sales App</h1>
    <div>
      <button onclick="switchView('route')">Route</button>
      <button onclick="switchView('catalog')">Catalog</button>
      <button id="logoutBtn" style="background:#dc3545;">Logout</button>
    </div>
  </nav>

  <div class="container">

    <!-- ================= ROUTE VIEW ================= -->
    <div id="route-view">

      <div class="card">
        <h3>ğŸ“ My Route Today</h3>
        <h2 id="route-name">Loading...</h2>
      </div>

      <div class="card">
        <h3>ğŸ¬ Shops to Visit</h3>
        <ul id="shops-list">
          <li>Loading...</li>
        </ul>
      </div>

    </div>

    <!-- ================= CATALOG VIEW ================= -->
    <div id="catalog-view" style="display:none;">

      <div class="card">
        <h3>ğŸ“‹ Product Catalog</h3>

        <input
          type="text"
          id="searchProd"
          placeholder="ğŸ” Search products..."
          style="width:100%; padding:10px; margin-bottom:15px;"
        />

        <div
          id="catalog-list"
          style="display:grid; grid-template-columns:repeat(auto-fill,minmax(140px,1fr)); gap:10px;"
        ></div>
      </div>

    </div>

    <!-- ================= VISIT VIEW ================= -->
    <div id="visit-view" style="display:none;">

      <button onclick="closeVisitPanel()" style="margin-bottom:10px;">
        â¬… Back to List
      </button>

      <div class="card">

        <h3 id="visit-shop-name">Shop Name</h3>

        <div
          id="map"
          style="height:250px; width:100%; border-radius:8px; margin:10px 0;"
        ></div>

        <div style="background:#eee; padding:10px; border-radius:5px; margin-bottom:10px;">
          <strong>Distance to Shop:</strong>
          <span id="dist-display">Calculating...</span>
        </div>

        <!-- ACTIONS -->
        <div id="visit-actions">

          <!-- CHECK IN -->
          <button
            id="btn-geo-checkin"
            class="btn-primary"
            style="width:100%;"
          >
            ğŸ“ Check In (Enter Fence)
          </button>

          <!-- IN-SHOP CONTROLS -->
          <div id="in-shop-controls" style="display:none; margin-top:15px;">
            <p style="color:green; font-weight:bold;">
              âœ… You are Checked In
            </p>

            <p>
              Duration:
              <span id="visit-timer">00:00</span>
            </p>

            <button
              id="btn-take-order"
              class="btn-primary"
              style="background:#6f42c1; width:100%; margin-bottom:10px;"
            >
              ğŸ“ Take Order
            </button>

            <button
              id="btn-end-visit"
              style="background:#dc3545; color:white; width:100%; padding:10px; border:none; border-radius:50px;"
            >
              â¹ End Visit
            </button>
          </div>

        </div>

      </div>
    </div>

  </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script type="module" src="js/salesman.js"></script>

</body>
</html>
