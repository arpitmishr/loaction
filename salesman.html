<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Salesman Dashboard</title>
    <link rel="stylesheet" href="css/style.css">
    
    <!-- LEAFLET MAPS CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body>
    <div id="loader">Loading...</div>

    <div id="content" style="display: none;">
        <nav>
            <h1>Sales Dashboard</h1>
            <button id="logoutBtn">Logout</button>
        </nav>
        
        <div class="container">
            <!-- VIEW 1: ROUTE LIST (Default) -->
            <div id="route-view">
                <div class="card">
                    <h3>üìç My Route Today</h3>
                    <h2 id="route-name">Loading...</h2>
                </div>
                <div class="card">
                    <h3>üè¨ Shops to Visit</h3>
                    <ul id="shops-list"><li>Loading...</li></ul>
                </div>
            </div>

            <!-- VIEW 2: ACTIVE VISIT PANEL (Hidden initially) -->
            <div id="visit-view" style="display: none;">
                <button onclick="closeVisitPanel()" style="margin-bottom:10px;">‚¨Ö Back to List</button>
                
                <div class="card">
                    <h3 id="visit-shop-name">Shop Name</h3>
                    
                    <!-- THE MAP -->
                    <div id="map" style="height: 250px; width: 100%; border-radius: 8px; margin: 10px 0;"></div>
                    
                    <div style="background:#eee; padding:10px; border-radius:5px; margin-bottom:10px;">
                        <strong>Distance to Shop:</strong> <span id="dist-display">Calculating...</span>
                    </div>

                    <!-- ACTIONS -->
                    <div id="visit-actions">
                        <!-- Step 1: Check In -->
                        <button id="btn-geo-checkin" class="btn-primary" style="width:100%;">üìç Check In (Enter Fence)</button>
                        
                        <!-- Step 2: In Shop Actions (Hidden until checked in) -->
                        <div id="in-shop-controls" style="display:none; margin-top:15px;">
                            <p style="color:green; font-weight:bold;">‚úÖ You are Checked In</p>
                            <p>Duration: <span id="visit-timer">00:00</span></p>
                            
                            <button id="btn-take-order" class="btn-primary" style="background: #6f42c1; width:100%; margin-bottom:10px;">üìù Take Order</button>
                            <button id="btn-end-visit" style="background: #dc3545; color: white; width:100%; padding:10px; border:none; border-radius:50px;">‚èπ End Visit</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- LEAFLET JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script type="module" src="js/salesman.js"></script>
</body>
</html>
